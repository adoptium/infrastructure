---

# no_log hides the api_token from the output
- name: Run deleteNodes script
  script: scripts/deleteNodes.py {{ jenkins_username }} {{ jenkins_api_token }} {{ delete_nodes }}
  args:
    executable: python3
  delegate_to: localhost
  no_log: true
  register: docker_ports

- name: Set docker_ports variable
  set_fact:
    ports_list: "{{ docker_ports.stdout_lines[0].split(' ') | list }}"

- name: Run delete_container.yml for every docker port
  include_tasks: delete_container.yml
  loop: "{{ ports_list }}"
  loop_control:
    loop_var: docker_port
